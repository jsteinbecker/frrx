{% extends 'main/base.html' %}
{% load static %}
{% load tags %}


{% block content %}

    {% backlink 'Cancel' '../' %}
    <h1>
        <span class="font-black">Shift Preferences</span>
        <span class="font-light opacity-75">{{ empl.name }}</span>
    </h1>
    <hr/>

    <script type="text/hyperscript">

        behavior
        Rank

            on dragover
                halt the event
                end
            on drop
                halt the event
                put .dragging at the end of me then
                tell .shift in me
                    set your@value-rank to my@value
                    end

    </script>

    <script type="text/hyperscript">

        behavior
        Shift

            on dragstart
                add .dragging to me
                end
            on dragend
                remove .dragging from me
                end
            on mutation of @data-rank
                if my@value-rank > my@value-from
                    call alert('gt')
                    end
                if my@value-rank < my@value-from
                    call alert('lt')
                    end
                end

    </script>

    <form method="POST">

        {% csrf_token %}

        <div class="container flex flex-row gap-1 lg:gap-4 overflow-x-scroll">

            {% for training in trainings %}

                <div class="rank bg-zinc-100 rounded bg-opacity-20 w-12 h-20 p-2"
                     value="{{ forloop.counter0 }}"
                     _="install Rank">

                        <span class="text-2xs opacity-50">{{ forloop.counter0 }}</span>

                        <div class="shift bg-transparent text-white"
                             draggable="true"
                             value-from="{{ training.rank }}"
                             value-rank="{{ training.rank }}"
                             _="install Shift">
                            <h2>{{ training.shift }}</h2>
                            <input type="hidden" name="shifts" value="{{ training.pk }}">
                        </div>

                </div>

            {% endfor %}

        </div>

        <button type="submit" class="btn btn-primary">Save</button>

    </form>

{% endblock %}